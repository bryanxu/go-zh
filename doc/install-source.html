<!--{
	"Title": "从源码安装Go",
	"Path": "/doc/install/source"
}-->

<!--{
	"Title": "Installing Go from source",
	"Path": "/doc/install/source"
}-->

<div class="english">
<h2 id="introduction">Introduction</h2>
</div>

<h2 id="前言">前言</h2>

<div class="english">
<p>
Go is an open source project, distributed under a
<a href="/LICENSE">BSD-style license</a>.
This document explains how to check out the sources,
build them on your own machine, and run them.
</p>
</div>

<p>
Go是一个开源项目，在<a href="/LICENSE">BSD风格授权</a>下发行。
本文档说明了如何检出源码，在你的机器上构建并运行它们。
</p>

<div class="english">
<p>
Most users don't need to do this, and will instead install
from precompiled binary packages as described in
<a href="/doc/install">Getting Started</a>,
a much simpler process.
If you want to help develop what goes into those precompiled
packages, though, read on.
</p>
</div>

<p>
大多数用户无需这些，而是按照<a href="/doc/install">起步</a>
中描述更简单的步骤通过预编译二进制包来安装。
若你想进入那些预编译包以帮助开发，那么，往下看。
</p>

<div class="detail">

<div class="english">
<p>
There are two official Go compiler tool chains.
This document focuses on the <code>gc</code> Go
compiler and tools (<code>6g</code>, <code>8g</code> etc.).
For information on how to work on <code>gccgo</code>, a more traditional
compiler using the GCC back end, see
<a href="/doc/install/gccgo">Setting up and using gccgo</a>.
</p>
</div>

<p>
官方有两个Go编译器工具链。本文档着重于 <code>gc</code> Go编译器及其工具
（<code>6g</code>、<code>8g</code> 等）。<code>gccgo</code> 是一个更传统的的编译器，
它使用GCC作为后端。关于如何使用它工作的信息，请访问<a href="/doc/install/gccgo">设置并使用gccgo</a>。
</p>

<div class="english">
<p>
The Go compilers support three instruction sets.
There are important differences in the quality of the compilers for the different
architectures.
</p>
</div>

<p>
Go编译器支持三种指令集，以下为在不同的架构上，编译器特性中重要的不同之处。
</p>

<div class="english">
<dl>
<dt>
	<code>amd64</code> (a.k.a. <code>x86-64</code>); <code>6g,6l,6c,6a</code>
</dt>
<dd>
	A mature implementation. The compiler has an effective
	optimizer (registerizer) and generates good code (although
	<code>gccgo</code> can do noticeably better sometimes).
</dd>
<dt>
	<code>386</code> (a.k.a. <code>x86</code> or <code>x86-32</code>); <code>8g,8l,8c,8a</code>
</dt>
<dd>
	Comparable to the <code>amd64</code> port.
</dd>
<dt>
	<code>arm</code> (a.k.a. <code>ARM</code>); <code>5g,5l,5c,5a</code>
</dt>
<dd>
	Supports only Linux binaries. Less widely used than the other ports and therefore
	not as thoroughly tested.
</dd>
</dl>
</div>

<dl>
<dt>
	<code>amd64</code>（即 <code>x86-64</code>）：<code>6g,6l,6c,6a</code>
</dt>
<dd>
	一个成熟的实现。此编译器拥有高效的优化器（寄存优化器）并能生成高质量的代码
	（当然，在某些事情上gccgo做得更好）。
</dd>
<dt>
	<code>386</code>（即 <code>x86</code> 或 <code>x86-32</code>）：<code>8g,8l,8c,8a</code>
</dt>
<dd>
	与 <code>amd64</code> 端口有可比之处。
</dd>
<dt>
	<code>arm</code>（即 <code>ARM</code>）：<code>5g,5l,5c,5a</code>
</dt>
<dd>
	只支持Linux二进制。与其他接口相比较少使用，因此并没有经过充分的测试。
</dd>
</dl>

<div class="english">
<p>
Except for things like low-level operating system interface code, the run-time
support is the same in all ports and includes a mark-and-sweep garbage
collector, efficient array and string slicing, and support for efficient
goroutines, such as stacks that grow and shrink on demand.
</p>
</div>

<p>
除了像低级操作系统接口代码这类东西外，其运行时支持在所有接口中都相同，还包括
标记-清除 垃圾回收器，高效的数组与字符串切片，并支持高效的Go程，例如按需求扩展或收缩栈。
</p>

<div class="english">
<p>
The compilers can target the FreeBSD, Linux, NetBSD, OpenBSD, OS X (Darwin),
and Windows operating systems.
The full set of supported combinations is listed in the discussion of
<a href="#environment">environment variables</a> below.
</p>
</div>

<p>
该编译器可将FreeBSD、Linux、NetBSD、OpenBSD、OS X (Darwin)以及Windows作为目标。
它所支持组合的完整集将在下文的<a href="#环境">环境变量</a>讨论中列出。
</p>
</div>

<div class="english">
<h2 id="ctools">Install C tools, if needed</h2>
</div>

<h2 id="c工具">若需要，则安装C工具</h2>

<div class="english">
<p>
The Go tool chain is written in C.
To build it, you need a C compiler installed.
</p>
</div>

<p>
Go工具链用C写成。要想构建它，你需要一个已安装的C编译器。
</p>

<div class="english">
<p>
On OS X, a C compiler can be installed as part of
<a href="http://developer.apple.com/Xcode/">Xcode</a>.
</p>
</div>

<p>
在OS X上，C编译器可作为<a href="http://developer.apple.com/Xcode/">Xcode</a>的一部分来安装。
</p>

<div class="english">
<p>
On Ubuntu/Debian, use <code>sudo apt-get install gcc libc6-dev</code>.
If you want to build 32-bit binaries on a 64-bit system you'll also need the
<code>libc6-dev-i386</code> package.
</p>
</div>

<p>
在Ubuntu/Debian上，可使用 <code>sudo apt-get install gcc libc6-dev</code> 安装。
若你想在64位系统上构建32位的二进制文件，还需要 <code>libc6-dev-i386</code> 包。
</p>

<div class="english">
<p>
On Windows, install <code>gcc</code> with
<a href="http://www.mingw.org/">MinGW</a>.
(Make sure you add its <code>bin</code> subdirectory to your <code>PATH</code>.)
</p>
</div>

<p>
On Windows, install <code>gcc</code> with
<a href="http://www.mingw.org/">MinGW</a>.
(Make sure you add its <code>bin</code> subdirectory to your <code>PATH</code>.)
</p>

<p>
在Windows上，可通过<a href="http://www.mingw.org/">MinGW</a>来安装 <code>gcc</code>。
（请确保你已将其 <code>bin</code> 子目录添加到 <code>PATH</code>中。）
</p>

<div class="english">
<h2 id="mercurial">Install Mercurial, if needed</h2>
</div>

<h2 id="hg">若需要，则安装Mercurial</h2>

<div class="english">
<p>
To perform the next step you must have Mercurial installed. (Check that you
have an <code>hg</code> command.)
</p>
</div>

<p>
要完成下一步，你必须安装Mercurial。（检查以下你是否有 <code>hg</code> 命令。）
</p>

<div class="english">
<p>
If you do not have a working Mercurial installation,
follow the instructions on the
<a href="http://mercurial.selenic.com/downloads/">Mercurial downloads</a> page.
</p>
</div>

<p>
若你没有可工作的Mercurial安装，请跟随
<a href="http://mercurial.selenic.com/downloads/">Mercurial下载</a>页面的说明进行操作。
</p>

<div class="english">
<p>
Mercurial versions 1.7.x and up require the configuration of
<a href="http://mercurial.selenic.com/wiki/CACertificates">Certification Authorities</a>
(CAs). Error messages of the form:
</p>
</div>

<p>
Mercurial版本1.7.x或更高需要
<a href="http://mercurial.selenic.com/wiki/CACertificates">认证权限</a>（CA）的配置。
其错误信息的形式为：
</p>

<div class="english">
<pre>
warning: code.google.com certificate with fingerprint b1:af: ... bc not verified (check hostfingerprints or web.cacerts config setting)
</pre>
</div>

<pre>
warning: code.google.com certificate with fingerprint b1:af: ... bc not verified (check hostfingerprints or web.cacerts config setting)
或
警告：code.google.com 的 b1:af: ... bc 指纹证书未经认证（请检查本地指纹或web证书配置设置）
</pre>

<div class="english">
<p>
when using Mercurial indicate that the CAs are missing.
Check your Mercurial version (<code>hg --version</code>) and
<a href="http://mercurial.selenic.com/wiki/CACertificates#Configuration_of_HTTPS_certificate_authorities">configure the CAs</a>
if necessary.
</p>
</div>

<p>
当使用Mercurial时，该信息表明缺少CA证书。如果需要，检查你的Mercurial版本
（<code>hg --version</code>）并<a href="http://mercurial.selenic.com/wiki/CACertificates#Configuration_of_HTTPS_certificate_authorities">配置CA证书</a>。
</p>


<div class="english">
<h2 id="fetch">Fetch the repository</h2>
</div>

<h2 id="获取">获取代码仓库</h2>

<div class="english">
<p>Go will install to a directory named <code>go</code>.
Change to the directory that will be its parent
and make sure the <code>go</code> directory does not exist.
Then check out the repository:</p>
</div>

<p>
Go将安装到名为 <code>go</code> 的目录。
切换到将成为其父目录的目录并确认 <code>go</code> 目录未被创建。
然后检出该仓库：
</p>

<pre>
$ hg clone -u release https://code.google.com/p/go
</pre>

<div class="english">
<h2 id="install">Install Go</h2>
</div>

<h2 id="安装">安装Go</h2>

<div class="english">
<p>
To build the Go distribution, run
</p>
</div>

<p>
要构建Go发行版，请运行
</p>

<pre>
$ cd go/src
$ ./all.bash
</pre>

<div class="english">
<p>
(To build under Windows use <code>all.bat</code>.)
</p>
</div>

<p>
（要在Windows下构建请使用 <code>all.bat</code>。）
</p>

<div class="english">
<p>
If all goes well, it will finish by printing output like:
</p>
</div>

<p>
若一切顺利，它将结束于打印输出，类似与：
</p>

<pre>
ALL TESTS PASSED

---
Installed Go for linux/amd64 in /home/you/go.
Installed commands in /home/you/go/bin.
*** You need to add /home/you/go/bin to your $PATH. ***
The compiler is 6g.
</pre>

<div class="english">
<p>
where the details on the last few lines reflect the operating system,
architecture, and root directory used during the install.
</p>
</div>

<p>
where the details on the last few lines reflect the operating system,
architecture, and root directory used during the install.
其中最后几行信息反映了操作系统、架构以及在安装中使用的根目录。
</p>

<div class="detail">
<div class="english">
<p>
For more information about ways to control the build, see the discussion of
<a href="#environment">environment variables</a> below.
</p>
</div>

<p>
For more information about ways to control the build, see the discussion of
<a href="#environment">environment variables</a> below.
更多有关控制构建方式的信息，见下文关于<a href="#环境">环境变量</a>的讨论。
</p>
</div>


<div class="english">
<h2 id="testing">Testing your installation</h2>
</div>

<h2 id="测试">测试你的安装</h2>

<div class="english">
<p>
Check that Go is installed correctly by building a simple program.
</p>
</div>

<p>
通过构建一个简单的程序来检查Go的安装是否正确。
</p>

<div class="english">
<p>
Create a file named <code>hello.go</code> and put the following program in it:
</p>
</div>

<p>
创建一个名为 <code>hello.go</code> 的文件，并将以下代码保存在其中：
</p>

<pre>
package main

import "fmt"

func main() {
    fmt.Printf("hello, world\n")
}
</pre>

<div class="english">
<p>
Then run it with the <code>go</code> tool:
</p>
</div>

<p>
接着通过 <code>go</code> 工具运行它：
</p>

<pre>
$ go run hello.go
hello, world
</pre>

<div class="english">
<p>
If you see the "hello, world" message then Go is installed correctly.
</p>
</div>

<p>
若你看到了“hello, world”信息，那么你的Go已被正确安装。
</p>


<div class="english">
<h2 id="community">Community resources</h2>
</div>

<h2 id="社区">社区资源</h2>

<div class="english">
<p>
The usual community resources such as
<code>#go-nuts</code> on the <a href="http://freenode.net/">Freenode</a> IRC server
and the
<a href="http://groups.google.com/group/golang-nuts">Go Nuts</a>
mailing list have active developers that can help you with problems
with your installation or your development work.
For those who wish to keep up to date,
there is another mailing list, <a href="http://groups.google.com/group/golang-checkins">golang-checkins</a>,
that receives a message summarizing each checkin to the Go repository.
</p>
</div>

<p>
一般的社区资源例如<a href="http://freenode.net/">Freenode</a> IRC服务器上的
<code>#go-nuts</code> 频道以及<a href="http://groups.google.com/group/golang-nuts">Go Nuts</a>
邮件列表有一些活跃的开发者可以帮助你的安装或开发工作问题。对于那些希望保持最新的人，有另一个邮件列表
<a href="http://groups.google.com/group/golang-checkins">golang-checkins</a>，它接收每一次对Go仓库的签入信息摘要。
</p>

<div class="english">
<p>
Bugs can be reported using the <a href="http://code.google.com/p/go/issues/list">Go issue tracker</a>.
</p>
</div>

<p>
Bug应当使用<a href="http://code.google.com/p/go/issues/list">Go问题跟踪系统</a>报告。
</p>


<div class="english">
<h2 id="发行">保持最新的发行版</h2>
</div>

<div class="english">
<p>
The Go project maintains two stable tags in its Mercurial repository:
<code>release</code> and <code>weekly</code>.
</p>
</div>

<p>
Go项目在其Mercurial仓库中维护两个稳定的标签：<code>release</code> 与 <code>weekly</code>。
</p>

<div class="english">
<p>
The <code>release</code> tag refers to the current stable release of Go.
Most Go users should use this version. New releases are announced on the
<a href="http://groups.google.com/group/golang-announce">golang-announce</a>
mailing list.
</p>
</div>

<p>
<code>release</code> 标签指当前Go的稳定发行版。大部分Go用户应当使用此版本。
新的发行版将在<a href="http://groups.google.com/group/golang-announce">golang-announce</a>
邮件列表中宣布。
</p>

<div class="english">
<p>
To update an existing tree to the latest release, you can run:
</p>
</div>

<p>
要将现有源码树更新到最新发行版，你可以运行：
</p>

<pre>
$ cd go/src
$ hg pull
$ hg update release
$ ./all.bash
</pre>

<div class="english">
<p>
The <code>weekly</code> tag is updated about once a week, and should be used
only by those who are actively working on the Go core.
To use the <code>weekly</code> tag run <code>hg update weekly</code> instead.
</p>
</div>

<p>
<code>weekly</code> 标签一般每星期更新一次，它应当只被那些活跃工作于Go核心的人使用。
要使用 <code>weekly</code> 标签，请运行 <code>hg update weekly</code> 来代替。
</p>


<div class="english">
<h2 id="environment">Optional environment variables</h2>
</div>

<h2 id="环境">可选环境变量</h2>

<div class="english">
<p>
The Go compilation environment can be customized by environment variables.
<i>None is required by the build</i>, but you may wish to set some
to override the defaults.
</p>
</div>

<p>
Go编译环境可通过环境变量定制。<i>构建无需它们</i>，但你或许希望设置一些来覆盖默认的值。
</p>

<blockquote>

<div class="english">
<p><code>$GOROOT</code></p>
<p>
The root of the Go tree, often <code>$HOME/go</code>.
Its value is built into the tree when it is compiled, and
defaults to the parent of the directory where <code>all.bash</code> was run.
There is no need to set this unless you want to switch between multiple
local copies of the repository.
</p>
</div>

<p><code>$GOROOT</code></p>
<p>
Go树的根，一般为 <code>$HOME/go</code>。其值在编译时构建成树，默认为
<code>all.bash</code> 所运行的目录的父目录。它一般无需设置，
除非你想在代码库的多个本地副本之间选择。
</p>

<div class="english">
<p><code>$GOROOT_FINAL</code></p>
<p>
The value assumed by installed binaries and scripts when
<code>$GOROOT</code> is not set explicitly.
It defaults to the value of <code>$GOROOT</code>.
If you want to build the Go tree in one location
but move it elsewhere after the build, set
<code>$GOROOT_FINAL</code> to the eventual location.
</p>
</div>

<p><code>$GOROOT_FINAL</code></p>
<p>
在 <code>$GOROOT</code> 未显式地设置时，其值由已安装二进制文件及脚本假定。
它默认为 <code>$GOROOT</code> 的值。若你想在某个位置构建Go树而不在构建后移动它，
那么就将 <code>$GOROOT_FINAL</code> 设置为最后的位置。
</p>

<div class="english">
<p><code>$GOOS</code> and <code>$GOARCH</code></p>
<p>
The name of the target operating system and compilation architecture.
These default to the values of <code>$GOHOSTOS</code> and
<code>$GOHOSTARCH</code> respectively (described below).
</p>
</div>

<p><code>$GOOS</code> 与 <code>$GOARCH</code></p>
<p>
目标操作系统与编译架构的名字。它们分别默认为 <code>$GOHOSTOS</code> 和
<code>$GOHOSTARCH</code> 的值（将在下文描述）。
</p>

<div class="english">
<p>
Choices for <code>$GOOS</code> are
<code>darwin</code> (Mac OS X 10.6 and above), <code>freebsd</code>,
<code>linux</code>, <code>netbsd</code>, <code>openbsd</code>,
<code>plan9</code>, and <code>windows</code>.
Choices for <code>$GOARCH</code> are
<code>amd64</code> (64-bit x86, the most mature port),
<code>386</code> (32-bit x86), and <code>arm</code> (32-bit ARM).
The valid combinations of <code>$GOOS</code> and <code>$GOARCH</code> are:
</p>
</div>

<p>
<code>$GOOS</code> 的选项为
<code>darwin</code>（Mac OS X 10.6及以上）、<code>freebsd</code>、
<code>linux</code>、<code>netbsd</code>、<code>openbsd</code>、
<code>plan9</code> 以及 <code>windows</code>。
<code>$GOARCH</code> 的选项为
<code>amd64</code>（64位x86，最成熟的端口）、
<code>386</code>（32位x86）以及 <code>arm</code>（32位ARM）。
<code>$GOOS</code> 与 <code>$GOARCH</code> 的有效组合为：
</p>

<table cellpadding="0">
<tr>
<th width="50"><th align="left" width="100"><code>$GOOS</code></th> <th align="left" width="100"><code>$GOARCH</code></th> <th align="left"></th></th>
</tr>
<tr>
<td></td><td><code>darwin</code></td> <td><code>386</code></td>
</tr>
<tr>
<td></td><td><code>darwin</code></td> <td><code>amd64</code></td>
</tr>
<tr>
<td></td><td><code>freebsd</code></td> <td><code>386</code></td>
</tr>
<tr>
<td></td><td><code>freebsd</code></td> <td><code>amd64</code></td>
</tr>
<tr>
<td></td><td><code>linux</code></td> <td><code>386</code></td>
</tr>
<tr>
<td></td><td><code>linux</code></td> <td><code>amd64</code></td>
</tr>
<tr>
<td></td><td><code>linux</code></td> <td><code>arm</code></td>
</tr>
<tr>
<td></td><td><code>netbsd</code></td> <td><code>386</code></td>
</tr>
<tr>
<td></td><td><code>netbsd</code></td> <td><code>amd64</code></td>
</tr>
<tr>
<td></td><td><code>openbsd</code></td> <td><code>386</code></td>
</tr>
<tr>
<td></td><td><code>openbsd</code></td> <td><code>amd64</code></td>
</tr>
<tr>
<td></td><td><code>plan9</code></td> <td><code>386</code></td>
</tr>
<tr>
<td></td><td><code>windows</code></td> <td><code>386</code></td>
</tr>
<tr>
<td></td><td><code>windows</code></td> <td><code>amd64</code></td>
</tr>
</table>

<div class="english">
<p><code>$GOHOSTOS</code> and <code>$GOHOSTARCH</code></p>
<p>
The name of the host operating system and compilation architecture.
These default to the local system's operating system and
architecture.
</p>
</div>

<p><code>$GOHOSTOS</code> 与 <code>$GOHOSTARCH</code></p>
<p>
宿主操作系统与编译架构的名字。它们默认为本地系统的操作系统与架构。
</p>

<div class="english">
<p>
Valid choices are the same as for <code>$GOOS</code> and
<code>$GOARCH</code>, listed above.
The specified values must be compatible with the local system.
For example, you should not set <code>$GOHOSTARCH</code> to
<code>arm</code> on an x86 system.
</p>
</div>

<p>
其有效选项与 <code>$GOOS</code> 以及 <code>$GOARCH</code> 相同，已在上文列出。
其指定的值必须与本地系统兼容。例如在x86系统上，你不能将 <code>$GOHOSTARCH</code>
设置为 <code>arm</code>。
</p>

<div class="english">
<p><code>$GOBIN</code></p>
<p>
The location where Go binaries will be installed.
The default is <code>$GOROOT/bin</code>.
After installing, you will want to arrange to add this
directory to your <code>$PATH</code>, so you can use the tools.
If <code>$GOBIN</code> is set, the <a href="/cmd/go">go command</a>
installs all commands there.
</p>
</div>

</p>
<code>$GOBIN</code>
<p>
Go二进制文件将安装的位置。它默认为 <code>$GOROOT/bin</code> 。
在安装之后，你会想要为整理而将此目录添加到你的 <code>$PATH</code> 中，
此时你可以使用此工具。若 <code>$GOBIN</code> 已经设置，
那么<a href="/cmd/go">go命令</a>会把所有命名都安装到这儿。
</p>

<div class="english">
<p><code>$GOARM</code> (arm, default=6)</p>
<p>
The ARM architecture version the run-time libraries should target.
Setting <code>$GOARM</code> to 5 causes the linker to emit calls
to a software floating point implementation instead of using
hardware floating point support.
</p>
</div>

<p><code>$GOARM</code> (arm, default=6)</p>
<p>
运行时库应当作为目标的ARM架构版本。将 <code>$GOARM</code>
设置为5会引起连接器发出指令来调用软件浮点数实现，而非使用硬件浮点数支持。
</p>

</blockquote>

<div class="english">
<p>
Note that <code>$GOARCH</code> and <code>$GOOS</code> identify the
<em>target</em> environment, not the environment you are running on.
In effect, you are always cross-compiling.
By architecture, we mean the kind of binaries
that the target environment can run:
an x86-64 system running a 32-bit-only operating system
must set <code>GOARCH</code> to <code>386</code>,
not <code>amd64</code>.
</p>
</div>

<p>
注意 <code>$GOARCH</code> 与 <code>$GOOS</code> 标识了<em>目标</em>环境，
而不是你正在运行的环境。实际上，你总是跨平台编译。通过此架构，
我们想要目标环境可以运行的二进制种类：x86-64系统运行32位的操作系统必须将
<code>GOARCH</code> 设置为 <code>386</code> 而非 <code>amd64</code>。
</p>

<div class="english">
<p>
If you choose to override the defaults,
set these variables in your shell profile (<code>$HOME/.bashrc</code>,
<code>$HOME/.profile</code>, or equivalent). The settings might look
something like this:
</p>
</div>

<p>
If you choose to override the defaults,
set these variables in your shell profile (<code>$HOME/.bashrc</code>,
<code>$HOME/.profile</code>, or equivalent). The settings might look
something like this:
若你选择覆盖默认值，需要在你的shell配置（<code>$HOME/.bashrc</code>、<code>$HOME/.profile</code>、或等价文件）中设置这些变量。该设置看起来可能像这样：
</p>

<pre>
export GOROOT=$HOME/go
export GOARCH=amd64
export GOOS=linux
</pre>

<div class="english">
<p>
although, to reiterate, none of these variables needs to be set to build,
install, and develop the Go tree.
</p>
</div>

<p>
再次重申一遍，构建、安装并开发Go树无需设置这些变量。
</p>
